<div class="bg-gray-50 py-12">
  <div class="container mx-auto px-4">
    <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-xl overflow-hidden">

      <div class="bg-cultura-violeta text-white p-6">
        <h1 class="text-3xl font-bold font-sans">Crear una cuenta</h1>
        <p class="mt-2">Únete a la comunidad SIMUS.</p>
      </div>

      <form [formGroup]="registroForm" (ngSubmit)="onSubmit()" class="p-8">

        <!-- Datos Personales -->
        <div class="mb-10">
          <h2 class="text-2xl font-semibold text-cultura-violeta border-b-2 border-cultura-amarillo pb-2 mb-6">Datos
            Personales</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">

            <!-- Primer Nombre -->
            <div>
              <label for="primerNombre" class="block text-sm font-medium text-gray-700">Primer Nombre *</label>
              <input id="primerNombre" type="text" formControlName="primerNombre"
                class="mt-1 block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cultura-violeta focus:border-transparent transition-shadow duration-200">
            </div>

            <!-- Segundo Nombre -->
            <div>
              <label for="segundoNombre" class="block text-sm font-medium text-gray-700">Segundo Nombre</label>
              <input id="segundoNombre" type="text" formControlName="segundoNombre"
                class="mt-1 block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cultura-violeta focus:border-transparent transition-shadow duration-200">
            </div>

            <!-- Primer Apellido -->
            <div>
              <label for="primerApellido" class="block text-sm font-medium text-gray-700">Primer Apellido *</label>
              <input id="primerApellido" type="text" formControlName="primerApellido"
                class="mt-1 block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cultura-violeta focus:border-transparent transition-shadow duration-200">
            </div>

            <!-- Segundo Apellido -->
            <div>
              <label for="segundoApellido" class="block text-sm font-medium text-gray-700">Segundo Apellido</label>
              <input id="segundoApellido" type="text" formControlName="segundoApellido"
                class="mt-1 block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cultura-violeta focus:border-transparent transition-shadow duration-200">
            </div>

            <!-- Fecha de Nacimiento -->
            <div>
              <label for="fechaNacimiento" class="block text-sm font-medium text-gray-700">Fecha de Nacimiento</label>
              <input id="fechaNacimiento" type="date" formControlName="fechaNacimiento"
                class="mt-1 block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cultura-violeta focus:border-transparent transition-shadow duration-200">
            </div>

            <!-- Tipo de Documento -->
            <div class="relative">
              <label for="tipoDocumento" class="block text-sm font-medium text-gray-700">Tipo de Documento *</label>
              <select id="tipoDocumento" formControlName="tipoDocumento"
                class="mt-1 block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-cultura-violeta focus:border-transparent appearance-none">
                <option value="" disabled>Seleccione...</option>
                <option *ngFor="let tipo of tiposDocumento" [value]="tipo">{{ tipo }}</option>
              </select>
              <img src="/assets/images/icons/chevron-down.svg" alt=""
                class="w-5 h-5 absolute right-4 top-10 pointer-events-none">
            </div>

            <!-- Número de Documento -->
            <div>
              <label for="numeroDocumento" class="block text-sm font-medium text-gray-700">Número de Documento *</label>
              <input id="numeroDocumento" type="text" formControlName="numeroDocumento"
                class="mt-1 block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cultura-violeta focus:border-transparent transition-shadow duration-200">
            </div>

            <!-- Sexo -->
            <div>
              <label class="block text-sm font-medium text-gray-700">Sexo</label>
              <div class="mt-3 flex space-x-6">
                <label class="inline-flex items-center">
                  <input type="radio" formControlName="sexo" value="Femenino"
                    class="form-radio h-5 w-5 text-cultura-violeta focus:ring-cultura-violeta focus:ring-offset-0">
                  <span class="ml-2 text-gray-700">Femenino</span>
                </label>
                <label class="inline-flex items-center">
                  <input type="radio" formControlName="sexo" value="Masculino"
                    class="form-radio h-5 w-5 text-cultura-violeta focus:ring-cultura-violeta focus:ring-offset-0">
                  <span class="ml-2 text-gray-700">Masculino</span>
                </label>
              </div>
            </div>

            <!-- Foto de Perfil -->
            <div class="md:col-span-2">
              <label class="block text-sm font-medium text-gray-700">Foto de perfil</label>

              <!-- Dropzone and Preview Container -->
              <div class="mt-1">
                <!-- State: No Image - Show Dropzone -->
                <div *ngIf="!imagePreview" (dragover)="onDragOver($event)" (dragleave)="onDragLeave($event)"
                  (drop)="onDrop($event)" [class.border-cultura-violeta]="isDragging"
                  class="flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md transition-colors duration-200">
                  <div class="space-y-1 text-center">
                    <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48"
                      aria-hidden="true">
                      <path
                        d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    <div class="flex text-sm text-gray-600">
                      <label for="file-upload"
                        class="relative cursor-pointer bg-white rounded-md font-medium text-cultura-violeta hover:text-cultura-violeta-dark focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-cultura-violeta">
                        <span>Sube un archivo</span>
                        <input id="file-upload" name="file-upload" type="file" class="sr-only"
                          (change)="onFileChange($event)" accept="image/png, image/jpeg">
                      </label>
                      <p class="pl-1">o arrástralo aquí</p>
                    </div>
                    <p class="text-xs text-gray-500">PNG, JPG hasta 1MB</p>
                  </div>
                </div>

                <!-- State: Image Preview -->
                <div *ngIf="imagePreview" class="relative w-48 h-48 mx-auto">
                  <img [src]="imagePreview" alt="Vista previa de la imagen"
                    class="w-full h-full object-cover rounded-lg shadow-md">
                  <button (click)="removeImage()" type="button"
                    class="absolute top-0 right-0 -mt-2 -mr-2 bg-red-600 text-white rounded-full h-8 w-8 flex items-center justify-center hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500">
                    <span class="sr-only">Eliminar imagen</span>
                    &times;
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Datos de Autenticación -->
        <div class="mb-10">
          <h2 class="text-2xl font-semibold text-cultura-violeta border-b-2 border-cultura-amarillo pb-2 mb-6">Datos de
            Autenticación</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
            <!-- Correo Electrónico -->
            <div class="md:col-span-2 relative">
              <label for="usuario" class="block text-sm font-medium text-gray-700">Correo electrónico *</label>
              <input id="usuario" type="email" formControlName="usuario"
                class="mt-1 block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cultura-violeta focus:border-transparent transition-shadow duration-200">

              <!-- Custom Domain Suggestions Dropdown -->
              <div *ngIf="showDomainSuggestions && emailSuggestions.length > 0"
                class="absolute z-10 mt-1 w-full bg-white rounded-md shadow-lg border border-gray-200 max-h-60 overflow-auto">
                <div *ngFor="let suggestion of emailSuggestions" (click)="selectDomain(suggestion)"
                  class="px-4 py-2 cursor-pointer hover:bg-gray-100 text-gray-800 text-sm">
                  {{ suggestion }}
                </div>
              </div>
            </div>

            <!-- Confirmar Correo Electrónico -->
            <div class="md:col-span-2">
              <label for="confcorreo" class="block text-sm font-medium text-gray-700">Confirmar correo electrónico
                *</label>
              <input id="confcorreo" type="email" formControlName="confcorreo"
                class="mt-1 block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cultura-violeta focus:border-transparent transition-shadow duration-200">
              <div
                *ngIf="registroForm.errors?.['emailMismatch'] && (registroForm.get('confcorreo')?.touched || registroForm.get('confcorreo')?.dirty)"
                class="mt-2 text-sm text-red-600">
                Los correos electrónicos no coinciden.
              </div>
            </div>

            <!-- Contraseña -->
            <div class="relative">
              <label for="contrasena" class="block text-sm font-medium text-gray-700">Contraseña *</label>
              <input id="contrasena" [type]="passwordVisible ? 'text' : 'password'" formControlName="contrasena"
                class="mt-1 block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cultura-violeta focus:border-transparent transition-shadow duration-200">
              <button type="button" (click)="passwordVisible = !passwordVisible"
                class="absolute inset-y-0 right-0 pr-3 flex items-center text-sm leading-5">
                <img [src]="passwordVisible ? 'assets/images/icons/eye-closed.svg' : 'assets/images/icons/eye.svg'"
                  class="h-6 w-6 text-cultura-violeta" alt="Toggle password visibility">
              </button>
              <p class="mt-2 text-xs text-gray-500">Mínimo 8 caracteres, mayúscula, minúscula y número.</p>
            </div>

            <!-- Confirmar Contraseña -->
            <div class="relative">
              <label for="confcontrasena" class="block text-sm font-medium text-gray-700">Confirmar contraseña *</label>
              <input id="confcontrasena" [type]="confirmPasswordVisible ? 'text' : 'password'"
                formControlName="confcontrasena"
                class="mt-1 block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cultura-violeta focus:border-transparent transition-shadow duration-200">
              <button type="button" (click)="confirmPasswordVisible = !confirmPasswordVisible"
                class="absolute inset-y-0 right-0 pr-3 flex items-center text-sm leading-5">
                <img
                  [src]="confirmPasswordVisible ? 'assets/images/icons/eye-closed.svg' : 'assets/images/icons/eye.svg'"
                  class="h-6 w-6 text-cultura-violeta" alt="Toggle password visibility">
              </button>
            </div>
          </div>
        </div>

        <!-- Datos de Ubicación -->
        <div class="mb-10">
          <h2 class="text-2xl font-semibold text-cultura-violeta border-b-2 border-cultura-amarillo pb-2 mb-6">Datos de
            Ubicación</h2>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-x-6 gap-y-4">
            <!-- País -->
            <div class="relative">
              <label for="pais" class="block text-sm font-medium text-gray-700">País *</label>
              <select id="pais" formControlName="pais"
                class="mt-1 block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-cultura-violeta focus:border-transparent appearance-none">
                <option value="" disabled>Seleccione...</option>
                <option *ngFor="let p of paises" [value]="p">{{ p }}</option>
              </select>
              <img src="/assets/images/icons/chevron-down.svg" alt=""
                class="w-5 h-5 absolute right-4 top-10 pointer-events-none">
            </div>

            <!-- Departamento -->
            <div class="relative">
              <label for="departamento" class="block text-sm font-medium text-gray-700">Departamento</label>
              <select id="departamento" formControlName="departamento"
                class="mt-1 block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-cultura-violeta focus:border-transparent appearance-none">
                <option value="" disabled>Seleccione...</option>
              </select>
              <img src="/assets/images/icons/chevron-down.svg" alt=""
                class="w-5 h-5 absolute right-4 top-10 pointer-events-none">
            </div>

            <!-- Municipio -->
            <div class="relative">
              <label for="municipio" class="block text-sm font-medium text-gray-700">Municipio</label>
              <select id="municipio" formControlName="municipio"
                class="mt-1 block w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-cultura-violeta focus:border-transparent appearance-none">
                <option value="" disabled>Seleccione...</option>
              </select>
              <img src="/assets/images/icons/chevron-down.svg" alt=""
                class="w-5 h-5 absolute right-4 top-10 pointer-events-none">
            </div>
          </div>
        </div>

        <!-- Términos y Footer -->
        <div class="border-t border-gray-200 pt-6">
          <div class="flex items-center">
            <input id="aceptaCondiciones" type="checkbox" formControlName="aceptaCondiciones"
              class="h-5 w-5 text-cultura-violeta border-gray-300 rounded focus:ring-cultura-violeta">
            <label for="aceptaCondiciones" class="ml-3 block text-sm text-gray-900">Acepto los <a href="#"
                class="font-medium text-cultura-violeta hover:underline">términos y condiciones</a> *</label>
          </div>

          <div class="mt-8 flex justify-end space-x-4">
            <button type="button"
              class="px-8 py-3 bg-gray-200 text-gray-800 font-bold rounded-lg hover:bg-gray-300 transition-colors duration-200"><a
                href="/">Regresar</a></button>
            <button type="submit" [disabled]="!registroForm.valid"
              class="px-8 py-3 bg-cultura-violeta text-white font-bold rounded-lg hover:bg-cultura-violeta-dark disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors duration-200">
              Guardar
            </button>
          </div>
        </div>

      </form>
    </div>
  </div>
</div>