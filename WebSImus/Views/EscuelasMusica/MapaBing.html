<html>
<head>
    <meta charset="utf-8">


    <script src="https://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0&amp;s=1" type="text/javascript"></script>
    <script type="text/javascript" src="/_static/_common/scripts/jquery1.7.2.min.js"></script>
    <script src="/WebResources/ClientGlobalContext.js.aspx"></script>
    <script src="/WebResources/new_ReadDataAsyncFunctionsStandalone.js"></script>
    <script src="/WebResources/new_ReadDataAsyncFunctionsStandalone.js"></script>

    <script type="text/javascript">

       
        function GetMap() {
           
            var entidadId = window.parent.Xrm.Page.data.entity.getId();
            var latitud = window.parent.Xrm.Page.getAttribute("new_latitud");
            var longitud = window.parent.Xrm.Page.getAttribute("new_longitud");

            if (entidadId != null) {
                var map = new Microsoft.Maps.Map(document.getElementById("mapDiv"),
                                 {
                                     credentials: "Ahxscxicg6S4-J58hW-xYY_dO3nP-MJXyKEQu1hHmbSkPyDhz52o5Mj2agAGHo0V",
                                     center: new Microsoft.Maps.Location(latitud.getValue(), longitud.getValue()),
                                     mapTypeId: Microsoft.Maps.MapTypeId.aerial,
                                     showMapTypeSelector: false,
                                     showDashboard: false,
                                     zoom: 15
                                 });


                var center = map.getCenter();

                // Add a pin to the center of the map
                var pin = new Microsoft.Maps.Pushpin(center, { text: 'Punto' });
                map.entities.push(pin);

                Microsoft.Maps.loadModule('Microsoft.Maps.Search', { callback: createSearchManager });

            }
        }
    </script>
</head>
<body style="margin: 0px; padding: 0px; word-wrap: break-word;" onload="GetMap();">



    <div id="mapDiv" style="margin: 0px; padding: 0px; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; position: fixed; z-index: 100;">
    </div>
</body>
</html>
